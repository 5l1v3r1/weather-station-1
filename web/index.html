<html>
<head>
  <meta charset="UTF-8"/>
  <meta http-equiv="cache-control" content="no-cache"/>
  <meta http-equiv="refresh" content="3600"/>
  <title>Outside Weather</title>
  <style>
    h2 { text-align: center; }
    .graph { width: 481px; height: 210px; float: left; padding: 10px; }
    #wind { width: 60px; height: 60px; text-align: center; vertical-align: middle; line-height: 60px; }
    td, th { padding-left: 30px; padding-right: 30px; text-align: center; vertical-align: middle; }
    th { color: #777; }
    .stat, #wind { font-size: 120%; font-weight: bold; }
  </style>
  <script src="scripts/jquery.min.js"></script>
  <script>
    function update_stats() {
      $.getJSON("argent_80422.json", function(data) {
        var wind_profile = $('#wind_profile').val();
        if (wind_profile == 'cur') {
		$('#wind').text(data.result[0].wind_speed_cur.toFixed(1));
		$('#wind').css("background-image", "url(\"images/wind-" + data.result[0].wind_dir_cur + ".png\")");
        }
        else if (wind_profile == 'gust_2m') {
                $('#wind').text(data.result[0].wind_speed_gust_2m.toFixed(1));
                $('#wind').css("background-image", "url(\"images/wind-" + data.result[0].wind_dir_gust_2m + ".png\")");
        }
        else if (wind_profile == 'avg_2m') {
                $('#wind').text(data.result[0].wind_speed_avg_2m.toFixed(1));
                $('#wind').css("background-image", "url(\"images/wind-" + (Math.round(data.result[0].wind_dir_avg_2m / 22.5) * 22.5) + ".png\")");
        }
        else if (wind_profile == 'gust_10m') {
                $('#wind').text(data.result[0].wind_speed_gust_10m.toFixed(1));
                $('#wind').css("background-image", "url(\"images/wind-" + data.result[0].wind_dir_gust_10m + ".png\")");
        }
        else if (wind_profile == 'avg_10m') {
                $('#wind').text(data.result[0].wind_speed_avg_10m.toFixed(1));
                $('#wind').css("background-image", "url(\"images/wind-" + (Math.round(data.result[0].wind_dir_avg_10m / 22.5) * 22.5) + ".png\")");
        }
        else if (wind_profile == 'gust_60m') {
                $('#wind').text(data.result[0].wind_speed_gust_60m.toFixed(1));
                $('#wind').css("background-image", "url(\"images/wind-" + data.result[0].wind_dir_gust_60m + ".png\")");
        }
        else if (wind_profile == 'avg_60m') {
                $('#wind').text(data.result[0].wind_speed_avg_60m.toFixed(1));
                $('#wind').css("background-image", "url(\"images/wind-" + (Math.round(data.result[0].wind_dir_avg_60m / 22.5) * 22.5) + ".png\")");
        }
        else {
                $('#wind').text("");
                $('#wind').css("background-image", "");
        }

        $('#rain_1h').text(data.result[0].rain_gauge_1h);
        $('#rain_6h').text(data.result[0].rain_gauge_6h);
        $('#rain_24h').text(data.result[0].rain_gauge_24h);
      });

      $.getJSON("temperature_humidity.json", function(data) {
        $('#temperature_number').text(data.result[0].temperature.toFixed(1));
        $('#humidity_number').text(data.result[0].humidity.toFixed(1));
        $('#dew_point_number').text(data.result[0].dew_point.toFixed(1));
      });

      $.getJSON("bmp180.json", function(data) {
        $('#pressure_in_number').text(data.result[0].pressure_in.toFixed(2));
        $('#pressure_mb_number').text(data.result[0].pressure_millibars.toFixed(1));
      });

      $.getJSON("battery.json", function(data) {
        $('#battery_number').text(data.result[0].millivolts.toFixed(0));
      });

      $.getJSON("booster.json", function(data) {
        $('#booster_number').text(data.result[0].millivolts.toFixed(0));
      });
    }

    $(document).ready(function() {
      update_stats();
      window.setInterval(update_stats, 10000);
    });
  </script>
</head>

<body>
  <table>
    <tr>
      <th>Temperature</th>
      <th>Humidity</th>
      <th>Wind</th>
      <th>Rain</th>
      <th>Pressure</th>
      <th>Dew Point</th>
      <th>Battery</th>
      <th>Booster</th>
    </tr>
    <tr>
      <td>
        <div class="stat"><span id="temperature_number"></span> F</div>
      </td>
      <td>
        <div class="stat"><span id="humidity_number"></span> %</div>
      </td>
      <td>
        <div id="wind"></div>
      </td>
      <td>
        <div>Last 1 hour: <span id="rain_1h"></span> in</div>
        <div>Last 6 hours: <span id="rain_6h"></span> in</div>
        <div>Last 24 hours: <span id="rain_24h"></span> in</div>
      </td>
      <td>
        <div class="stat"><span id="pressure_in_number"></span> in</div>
        <div class="stat"><span id="pressure_mb_number"></span> millibars</div>
      </td>
      <td>
        <div class="stat"><span id="dew_point_number"></span> F</div>
      </td>
      <td>
        <div class="stat"><span id="battery_number"></span> mV</div>
      </td>
      <td>
        <div class="stat"><span id="booster_number"></span> mV</div>
      </td>
    </tr>
    <tr>
      <td></td>
      <td></td>
      <td>
        <form>
          <select name="wind_profile" id="wind_profile" onchange="update_stats();">
            <option value="cur" checked="1">Current Speed</input>
            <option value="avg_2m">2 minute average</input>
            <option value="gust_2m">2 minute gust</input>
            <option value="avg_10m">10 minute average</input>
            <option value="gust_10m">10 minute gust</input>
            <option value="avg_60m">60 minute average</input>
            <option value="gust_60m">60 minute gust</input>
          <select>
        </form>
      </td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </table>

  <div>
    <div class="graph"><img src="temperature_humidity_daily.png"/></div>
    <div class="graph"><img src="wind_speed_daily.png"/></div>
    <div class="graph"><img src="rain_gauge_daily.png"/></div>
    <div class="graph"><img src="pressure_in_daily.png"/></div>
    <div class="graph"><img src="battery_daily.png"/></div>
    <div class="graph"><img src="booster_daily.png"/></div>
  </div>
</body>
</html>
